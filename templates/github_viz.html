<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" type="text/css" href="/static/github_viz.css">
		<!-- <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}"> -->
		<link href='http://fonts.googleapis.com/css?family=Pacifico|Raleway' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
		 <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
		<script src="/static/Chart.js"></script>
		<title>Github Language Visualization</title>
		<meta name=”description” content=”Github language visualization by Becca Bruggman”>
	</head>


	<body>
		<div class="title"> Github graph! </div>
		<div class="form_container">
			<form action="/" method="POST" name= "username_submit">
				{% from "_formhelpers.html" import render_field %}
					<div id="submitText"> Username: {{form.username(placeholder="Enter your username", size="25")}} </div>
					<input type="submit" value="SUBMIT" class="Submit">
			</form>
		</div>
		{% if github_viz is mapping %}
			<div class="data_container">
				<div class="wrapper">
					<div class="chart_container">
						<canvas id="myChart" width="300" height="300"></canvas>
					</div>

					<div class="share_container">
						<a href="https://instagram.com/bexcitement" target="_blank"><i class="fa fa-instagram"></i> </a>
						<a href="https://facebook.com/becca.bruggman" target="_blank"><i class="fa fa-facebook"></i> </a>
						<a href="https://twitter.com/bexcitement" target="_blank"><i class="fa fa-twitter"></i></a>
						<a href="http://www.linkedin.com/in/rebeccabruggman/en" target="_blank"><i class="fa fa-linkedin"></i></a>
					</div>
				</div>
			</div>

		{% elif github_viz is string %}
			<div class="user_invalid">
				<div class="title"> We can't find that github handle... </div>
				<img class="pusheen" src="http://media.giphy.com/media/ktvFa67wmjDEI/giphy.gif" alt="Sad Pusheen"/>
			</div>
		{% endif %}



		<script type="text/javascript">

			var total = 0;
			var colors = {
				"Red": {
					"color":"#F7464A",
			        "highlight": "#F7464A",
				},
				"Green": {
					"color": "#46BFBD",
			        "highlight": "#5AD3D1"
				},
				"Yellow": {
					"color": "#FDB45C",
			        "highlight": "#FFC870"
				},
				"Light Salmon": {
					"color":"#ffa07a",
			        "highlight": "#ffa07a",
				},
				"Purple": {
					"color": "#730073",
			        "highlight": "#730073"
				},
				"Sky Blue": {
					"color": "#b2b2ff",
			        "highlight": "#b2b2ff"
				},
				"Orange": {
					"color":"#ff2500",
			        "highlight": "#ff2500",
				},
				"Bright Green": {
					"color": "#00ff25",
			        "highlight": "#00ff25"
				},
				"Hot Pink": {
					"color": "#ff005a",
			        "highlight": "#ff005a"
				},
				"Aqua": {
					"color":"#00824b",
			        "highlight": "#00824b",
				},
				"Golden Rod": {
					"color": "#cf7700",
			        "highlight": "#cf7700"
				},
				"Pea Green": {
					"color": "#788200",
			        "highlight": "#788200"
				}

			};

				var options = [
			{
			    //Boolean - Whether we should show a stroke on each segment
			    segmentShowStroke : true,

			    //String - The colour of each segment stroke
			    segmentStrokeColor : "#fff",

			    //Number - The width of each segment stroke
			    segmentStrokeWidth : 2,

			    //Number - The percentage of the chart that we cut out of the middle
			    percentageInnerCutout : 50, // This is 0 for Pie charts

			    //Number - Amount of animation steps
			    animationSteps : 100,

			    //String - Animation easing effect
			    animationEasing : "easeOutBounce",

			    //Boolean - Whether we animate the rotation of the Doughnut
			    animateRotate : true,

			    //Boolean - Whether we animate scaling the Doughnut from the centre
			    animateScale : false

				}
			];

			var data = [];

			{% if github_viz is mapping %}
				console.log('we made it')
				$(".chart_container").after("<div class='languages_container'><div class='user'>{{username}}</div></div>")
				{% for lang, num in github_viz.iteritems() %}
					total+= {{num}}

					data.push({
						value: {{num}},
						label: "{{lang}}",
						color: colors[Object.keys(colors)[{{loop.index-1}}]]['color'],
						highlight: colors[Object.keys(colors)[{{loop.index-1}}]]['highlight']

					})

					// need to sort based on num
					$(".languages_container").append('<div class="coding_language"> {{lang}} : <span class="lang_num">{{num}}</span><span class="num_hover">{{num}}kb</span></div>')

				{% endfor %}

			
	
				var ctx = $("#myChart").get(0).getContext("2d");
				var myPieChart = new Chart(ctx).Pie(data,options);
				{% if followers is defined %}
					$(".data_container").after('<div class="followers_container"> Check out what languages your followers work with: </div>')
					{% for follower in followers %}
						$(".followers_container").append('<div class="follower_name"> <a href="/follower_chart/{{follower}}">{{follower}}</a></div>')

					{% endfor %}
				{% endif %}

				$('.lang_num').each(function() {
					var lang_num = $(this).text();
					$(this).text(((lang_num / total) * 100).toFixed(1) + '%')


				});
				
			{% endif %}



			
		</script>
		
	</body>

</html>
